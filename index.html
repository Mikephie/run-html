<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>302 跳转地址获取测试</title>
<style>
  body { font-family: sans-serif; padding: 20px; background: #111; color:#eee; }
  input { width: 80%; padding: 10px; margin-bottom:10px; font-size:16px; }
  button { padding:10px 20px; font-size:16px; }
  pre { padding:10px; background:#222; color:#0f0; white-space:pre-wrap; }
</style>
</head>
<body>
<h2>获取 302 最终直链测试</h2>

<input id="testUrl" placeholder="输入一个 302 链接，如 https://example.com/xxx">

<button onclick="getFinal()">获取跳转后地址</button>

<pre id="log"></pre>

<script>
async function getFinal() {
  const log = document.getElementById("log");
  const url = document.getElementById("testUrl").value.trim();
  if (!url) return log.textContent = "请输入 URL！";

  log.textContent = "探测中...\n";

  try {
    const response = await fetch(url, {
      method: "GET",
      redirect: "follow",
      headers: {
        "Range": "bytes=0-0" // 只探前几个字节
      }
    });

    const finalUrl = response.url;
    const status = response.status;

    log.textContent += `状态: ${status}\n最终URL:\n${finalUrl}\n`;

  } catch (err) {
    log.textContent += "❌ 错误:\n" + err;
  }
}
</script>

</body>
</html>
